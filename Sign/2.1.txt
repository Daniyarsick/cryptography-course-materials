# Электронная подпись RSA без секретной передачи сообщения
# Аннануров Даниил 3 курс

with(numtheory):
with(RandomTools):
P:= nextprime(Generate(integer(range=3..10^10))); # Генерируем большое простое число P
Q:= nextprime(Generate(integer(range=3..10^5))); # Генерируем простое число Q
m:= P*Q; phm:=phi(m); # Вычисляем модуль n = P*Q и функцию Эйлера
d:=prevprime(phm); # Выбираем закрытый ключ d
e:=d &^(-1) mod phm; # Вычисляем открытый ключ e
x:=80085; # Исходное сообщение
s:=x&^d mod m; # Создаем электронную подпись
x2:=s&^e mod m; # Проверяем подпись


