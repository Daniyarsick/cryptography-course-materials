# Электронная подпись RSA без секретной передачи сообщения с хешированием
# Аннануров Даниил 3 курс
with(numtheory):
with(RandomTools):
P:= nextprime(Generate(integer(range=3..10^10))); # Генерируем большое простое число P
Q:= nextprime(Generate(integer(range=3..10^5))); # Генерируем простое число Q
m:= P*Q; phm:=phi(m); # Вычисляем модуль n = P*Q и функцию Эйлера
d:=prevprime(phm); # Выбираем закрытый ключ d
e:=d &^(-1) mod phm; # Вычисляем открытый ключ e
x:=12345; # Исходное сообщение
hash:= (x) -> x mod 10000; # Определяем хеш-функцию
y:= hash(x); # Вычисляем хеш сообщения
s:=y&^d mod m; # Создаем подпись хеша
w:=s&^e mod m; # Проверяем подпись
w=y; # Сравниваем результат с хешем