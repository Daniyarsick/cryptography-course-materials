# Протокол подписи "вслепую"
# Аннануров Даниил 3 курс
with(numtheory):
with(RandomTools):
P:= nextprime(Generate(integer(range=3..10^10))); # Генерируем большое простое число P
Q:= nextprime(Generate(integer(range=3..10^5))); # Генерируем простое число Q
n:= P*Q; 		  # Часть открытого ключа проверки подписи
e:= prevprime(phi(n));  # Часть открытого ключа проверки подписи
d:= e&^(-1) mod phi(n); # Закрытый ключ создания подписи
m:= 12345; # сообщение
r:= prevprime(n); # Генерируем случайное число для маскировки
m1:= r&^e mod n; 	  # Отправлено отправителю
s1:= r*m&^d mod n; 	  # Подписанное сообщение
s:=s1*r&^(-1) mod n     # Значение подписи
s&^e mod n = m;  	  # Проверка подлинности