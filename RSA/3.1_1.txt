# Алгоритм криптографической системы с открытым ключом;
# Аннануров Даниил 3 курс
with(numtheory):
with(RandomTools):
# Генерируем большие простые числа p1 и p2
p1:= nextprime(Generate(integer(range=3..10^10)));
p1:= nextprime(Generate(integer(range=3..10^5)));
# Вычисляем произведение простых чисел
ra := p1*p2;
# Находим значение функции Эйлера
pra := phi(ra);
# Выбираем открытый ключ
a := prevprime(pra);
# Вычисляем закрытый ключ
alpha := a^(-1) mod pra;
# Исходное сообщение
m := 101;
# Шифрование сообщения
m1 := m&^a mod ra;
# Расшифрование сообщения
m2 := m1&^alpha mod ra;