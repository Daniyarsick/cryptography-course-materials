# Аннануров Даниил 3 курс
# Атака методом неподвижной точки

with(numtheory):
with(RandomTools):

# Генерация параметров RSA
p:= nextprime(Generate(integer(range=3..10^5)));
q:= nextprime(Generate(integer(range=3..10^5)));
n:=p*q;
# Выбор экспоненты, близкой к φ(n) (создает уязвимость)
e:= prevprime(phi(n));

# Шифрование сообщения
m:=193263 mod n;				# исходное сообщение
c:=m&^e mod n;					# зашифрованное сообщение

# Криптоанализ: поиск неподвижной точки
k:=1;							# счетчик итераций
ce:=c&^e mod n;					# первое возведение в степень
# Итеративное возведение в степень до достижения неподвижной точки
while ce <> c and k < 10^7 do
k:=k+1;
ce:= ce&^e mod n;
end do:
'k' = k;						# количество итераций до неподвижной точки

# Восстановление исходного сообщения
ek:=e^(k-1):					# вычисление e^(k-1)
m2:=c&^(ek) mod n;				# дешифрование

# Проверка корректности восстановления
m2 - m;

