# Аннануров Даниил 3 курс
# Атака угадыванием значения функции Эйлера

with(RandomTools):
with(numtheory):

# Генерация секретных простых чисел (имитация создания ключа)
# Генерация двух случайных простых чисел q и p
q:= nextprime(Generate(integer(range=3..10^10)));
p:= nextprime(Generate(integer(range=q..10^10)));

# Формирование открытого ключа
# Вычисление модуля RSA
rb:= q*p;
# Вычисление значения функции Эйлера φ(rB)
phrb:= phi(rb);

# Криптоанализ: атака через систему уравнений
# Объявление переменных для решения системы уравнений
p1:= 'p1';
q1:='q1'; _Z1:=1:

# Решение системы уравнений для восстановления p и q по rb и φ(rb)
# Используем известные соотношения:
# p1 * q1 = rb
# p1 + q1 = rb - phrb + 1
ex:= isolve({p1*q1 = rb, p1 + q1 = rb - phrb + 1});
# Присваивание найденных значений переменным p1 и q1
assign(ex);

# Проверка корректности восстановления простых чисел
p1 - p;
q1 - q;